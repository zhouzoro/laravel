"use strict";function addTocItem(o){var e=$(this),t=$("<a>").attr({href:o.attr("id"),"class":"toc-item "+o.prop("tagName")});e.append(t)}function getTOC(){console.log("adding toc");var o=$(this);o.addTocItem=addTocItem;var e=$(o.data("target")),t=0;e.find("h2").each(function(){$(this).attr("id","h2-"+t),o.addTocItem($(this));$(this).find("h3").each(function(){$(this).attr("id","h3-"+t),o.addTocItem($(this))})})}function goBack(){-1!==document.referrer.indexOf(window.location.host)&&history.back()}function logOut(){Cookies.remove("email"),Cookies.remove("username"),window.location="/"}function login(){if(!validateInputs())return 0;var o=new XMLHttpRequest;o.open("POST","/login"),o.onload=function(){var e=JSON.parse(o.responseText);console.log(e),"200"==e.status?(goBack(),showTipMsg("登录成功",1),Cookies.set("username",e.username,{expires:7}),Cookies.set("email",e.email,{expires:7})):"504"==e.status&&(showTipMsg("登录失败: "+e.msg,0),showInputValidation("email",0))};var e=new FormData($("form#login")[0]);o.send(e)}function signup(){if(!validateInputs(1))return 0;var o=new XMLHttpRequest;o.open("POST","/signup"),o.onload=function(){var e=JSON.parse(o.responseText);"200"==e.status?(goBack(),showTipMsg("注册成功",1),Cookies.set("email",e.email,{expires:7}),Cookies.set("username",e.username,{expires:7})):"504"==e.status&&(showTipMsg("注册失败: "+e.msg,0),showInputValidation("email",0))};var e=new FormData($("form#login")[0]);o.send(e)}function setLogin(){Cookies.get("email")&&($(".login-ops").addClass("hidden"),$(".user-ops").removeClass("hidden"),$("label.username").text(Cookies.get("username")),$(".user-access-btn").addClass("disabled"),Cookies.set("email",Cookies.get("email"),{expires:7}),Cookies.set("username",Cookies.get("username"),{expires:7}))}function setReplistNav(){if($(".report-intro-list-nav")[0]){var o=$(".report-intro-list"),e=function(){var e=$(".report-intro-list .item").length,t=1;return{up:function(){t>2?t-=2:t=1,o.css("transform","translateY("+108*(1-t)+"px)")},down:function(){e-t>2?t+=2:t=e-1,o.css("transform","translateY("+108*(1-t)+"px)")}}}();$(".report-intro-list-nav.up").click(e.up),$(".report-intro-list-nav.down").click(e.down)}}function setInfoNav(){if($(".info-center")[0]){var o=$(".info-content-list");$(".service-menu .item").click(function(){var e=$(".info-content").height();console.log(e),console.log($(this)),o.css("transform","translateY("+-255*($(this).data("index")-1)+"px)")})}}function toggleSidebar(){$(".sidebar").sidebar("toggle")}function ScrollTop(){var o=$("html, body");o.stop().animate({scrollTop:0},"500")}function showScrollTop(){checkVisible($("#top-indicator"))?($("#vertical-nv").removeClass("pinned").addClass("normal"),$("#scroll-top").removeClass("in").addClass("out")):($("#vertical-nv").removeClass("normal").addClass("pinned"),$("#scroll-top").removeClass("out").addClass("in"))}function changeToolBarPosition(){var o=$(".mce-toolbar-grp.mce-container.mce-panel.mce-stack-layout-item.mce-first"),e=$("#ops");o[0]&&(checkVisible($(".mce-top-indicator"))?o.removeClass("pinned"):o.addClass("pinned")),e[0]&&(checkVisible($("footer"))?e.removeClass("pinned"):e.addClass("pinned"))}function checkVisible(o,e){e=e||"visible";var t=$(window).height(),i=$(window).scrollTop(),n=$(o).offset().top,s=$(o).height();return"visible"===e?t+i>n&&n>i-s:"above"===e?t+i>n:void 0}function scrollTo(o){var e=$("html, body");e.stop().animate({scrollTop:$(o).offset().top},"500")}function validateEmail(o){var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(o)}function showTipMsg(o,e){var t=e?"green":"red";$("p.tip-message").text(o).css({background:e?"rgba(55,222,88,0.3)":"rgba(222,55,88,0.3)",color:t,border:"1px solid "+t})}function showInputValidation(o,e){var t=$('input[name="'+o+'"]'),i=$(".input."+o);return e||(i.addClass("error"),t.focus(),t.change(function(){i.removeClass("error"),validateInput(t)})),e}function validateInput(o){var e=o.attr("name");return"email"==e?showInputValidation(e,validateEmail(o.val())):"password"==e?showInputValidation(e,validatePwd(o.val())):"repassword"==e?o.val()===$('input[name="password"]').val():void 0}function validateInputs(o){if(!showInputValidation("email",validateEmail($('input[name="email"]').val())))return showTipMsg("邮件格式不正确",0),0;if(o){if(!showInputValidation("password",validatePwd($('input[name="password"]').val())))return showTipMsg("密码至少6位，并同时包含数字和字母",0),0;if(!showInputValidation("repassword",$('input[name="repassword"]').val()===$('input[name="password"]').val()))return showTipMsg("两次密码输入不相符",0),0}return 1}function validatePwd(o){var e=/^(?=.*\d)(?=.*\w)[\d\w]{6,}$/;return e.test(o)}function getQuoteText(o){var e="";return $(o).find("*").each(function(){return $(this).text().length>32?(e=$(this).text(),!1):void 0}),e}$(document).ready(function(){if(setLogin(),$(".carousel").carousel({interval:8e3}),$("#toc").each(getTOC),setReplistNav(),setInfoNav(),$(".user-button.button").popup({popup:$(".user-ops-popup.popup"),position:"bottom right",on:"click"}),$("#login").length){console.log(1);new Vue({el:"#login",data:{issignup:0,name:["登录","注册"],submitFuncs:[login,signup]},methods:{switchPage:function(){this.issignup=1-this.issignup},submit:function(){this.submitFuncs[this.issignup]()}}})}var o={scrollRecord:[0,0],init:function(){o.setPosition()},setPosition:function(){o.position=$(window).scrollTop()},recordScroll:function(){o.scrollRecord[1]=o.scrollRecord[0],o.scrollRecord[0]=$(window).scrollTop()>o.position?-1:1,o.position=$(window).scrollTop(),o.direction=-1===o.scrollRecord[0]?"down":"up",o.continuous=o.scrollRecord[0]===o.scrollRecord[1]},adaptResize:function(){o.init()}};o.init,changeToolBarPosition(),$(window).resize(o.adaptResize),$(document).scroll(function(){changeToolBarPosition()})});
//# sourceMappingURL=../maps/main.babeled.min.js.map
